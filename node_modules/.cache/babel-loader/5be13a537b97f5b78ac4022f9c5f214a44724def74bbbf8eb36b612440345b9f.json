{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, vModelSelect as _vModelSelect, withDirectives as _withDirectives, vModelText as _vModelText, normalizeStyle as _normalizeStyle, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-7ba5bd90\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  id: \"app\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"header\", null, [/*#__PURE__*/_createElementVNode(\"h1\", null, \"餐點碳排放計算機\"), /*#__PURE__*/_createElementVNode(\"p\", null, \"計算您的餐點的碳排放量，助力環保\")], -1 /* HOISTED */));\nconst _hoisted_3 = {\n  class: \"ingredient-selection\"\n};\nconst _hoisted_4 = [\"onUpdate:modelValue\", \"onChange\"];\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"option\", {\n  disabled: \"\",\n  value: \"\"\n}, \"選擇種類\", -1 /* HOISTED */));\nconst _hoisted_6 = [\"value\"];\nconst _hoisted_7 = [\"onUpdate:modelValue\", \"onChange\"];\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"option\", {\n  disabled: \"\",\n  value: \"\"\n}, \"選擇名稱\", -1 /* HOISTED */));\nconst _hoisted_9 = [\"value\"];\nconst _hoisted_10 = [\"onUpdate:modelValue\"];\nconst _hoisted_11 = {\n  class: \"button-group\"\n};\nconst _hoisted_12 = {\n  key: 0,\n  class: \"results\"\n};\nconst _hoisted_13 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", null, \"總碳排放量\", -1 /* HOISTED */));\nconst _hoisted_14 = {\n  id: \"bar-container\",\n  style: {\n    \"display\": \"flex\",\n    \"height\": \"20px\"\n  }\n};\nconst _hoisted_15 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"footer\", null, \" © 2024 餐點碳排放計算機 | 聯絡我們: (089)326141~326146 \", -1 /* HOISTED */));\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"main\", null, [_createCommentVNode(\" 新增：使用 v-for 迴圈生成不同類別的選擇器 \"), _createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.categories, (category, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      class: \"ingredient-row\"\n    }, [_createCommentVNode(\" 類別選擇 \"), _withDirectives(_createElementVNode(\"select\", {\n      \"onUpdate:modelValue\": $event => $data.selectedCategories[index] = $event,\n      onChange: $event => $options.fetchItems(index)\n    }, [_hoisted_5, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.categories, cat => {\n      return _openBlock(), _createElementBlock(\"option\", {\n        key: cat.category_id,\n        value: cat\n      }, _toDisplayString(cat.category_name), 9 /* TEXT, PROPS */, _hoisted_6);\n    }), 128 /* KEYED_FRAGMENT */))], 40 /* PROPS, NEED_HYDRATION */, _hoisted_4), [[_vModelSelect, $data.selectedCategories[index]]]), _createCommentVNode(\" 項目選擇 \"), _withDirectives(_createElementVNode(\"select\", {\n      \"onUpdate:modelValue\": $event => $data.selectedItems[index] = $event,\n      onChange: $event => $options.setEmission(index)\n    }, [_hoisted_8, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.items[index], item => {\n      return _openBlock(), _createElementBlock(\"option\", {\n        key: item.item_id,\n        value: item\n      }, _toDisplayString(item.item_name), 9 /* TEXT, PROPS */, _hoisted_9);\n    }), 128 /* KEYED_FRAGMENT */))], 40 /* PROPS, NEED_HYDRATION */, _hoisted_7), [[_vModelSelect, $data.selectedItems[index]]]), _createCommentVNode(\" 數量輸入 \"), _withDirectives(_createElementVNode(\"input\", {\n      type: \"number\",\n      \"onUpdate:modelValue\": $event => $data.quantities[index] = $event,\n      placeholder: \"請輸入數值\"\n    }, null, 8 /* PROPS */, _hoisted_10), [[_vModelText, $data.quantities[index]]])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createCommentVNode(\" 按鈕組 \"), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"button\", {\n    class: \"reset-button\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.resetAll && $options.resetAll(...args))\n  }, \"重新計算\"), _createElementVNode(\"button\", {\n    class: \"calculate-button\",\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.calculateEmissions && $options.calculateEmissions(...args))\n  }, \"計算碳排放\")]), _createCommentVNode(\" 結果部分 \"), $data.totalEmission > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [_hoisted_13, _createElementVNode(\"p\", null, _toDisplayString($data.totalEmission) + \" kg CO₂e\", 1 /* TEXT */), _createCommentVNode(\" 新增：視覺化條形圖 \"), _createElementVNode(\"div\", _hoisted_14, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.percentages, (percentage, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      style: _normalizeStyle({\n        backgroundColor: $data.colors[index],\n        width: percentage + '%'\n      })\n    }, null, 4 /* STYLE */);\n  }), 128 /* KEYED_FRAGMENT */))])])) : _createCommentVNode(\"v-if\", true)]), _hoisted_15]);\n}","map":{"version":3,"names":["id","_createElementVNode","class","disabled","value","key","style","_createElementBlock","_hoisted_1","_hoisted_2","_createCommentVNode","_hoisted_3","_Fragment","_renderList","$data","categories","category","index","$event","selectedCategories","onChange","$options","fetchItems","_hoisted_5","cat","category_id","category_name","_hoisted_6","_hoisted_4","selectedItems","setEmission","_hoisted_8","items","item","item_id","item_name","_hoisted_9","_hoisted_7","type","quantities","placeholder","_hoisted_10","_hoisted_11","onClick","_cache","args","resetAll","calculateEmissions","totalEmission","_hoisted_12","_hoisted_13","_toDisplayString","_hoisted_14","percentages","percentage","_normalizeStyle","backgroundColor","colors","width","_hoisted_15"],"sources":["C:\\Users\\user\\carbon-calculator\\src\\App.vue"],"sourcesContent":["<template>\r\n  <div id=\"app\">\r\n    <header>\r\n      <h1>餐點碳排放計算機</h1>\r\n      <p>計算您的餐點的碳排放量，助力環保</p>\r\n    </header>\r\n\r\n    <main>\r\n      <!-- 新增：使用 v-for 迴圈生成不同類別的選擇器 -->\r\n      <div class=\"ingredient-selection\">\r\n        <div v-for=\"(category, index) in categories\" :key=\"index\" class=\"ingredient-row\">\r\n          <!-- 類別選擇 -->\r\n          <select v-model=\"selectedCategories[index]\" @change=\"fetchItems(index)\">\r\n            <option disabled value=\"\">選擇種類</option>\r\n            <option v-for=\"cat in categories\" :key=\"cat.category_id\" :value=\"cat\">\r\n              {{ cat.category_name }}\r\n            </option>\r\n          </select>\r\n          \r\n          <!-- 項目選擇 -->\r\n          <select v-model=\"selectedItems[index]\" @change=\"setEmission(index)\">\r\n            <option disabled value=\"\">選擇名稱</option>\r\n            <option v-for=\"item in items[index]\" :key=\"item.item_id\" :value=\"item\">\r\n              {{ item.item_name }}\r\n            </option>\r\n          </select>\r\n\r\n          <!-- 數量輸入 -->\r\n          <input type=\"number\" v-model=\"quantities[index]\" placeholder=\"請輸入數值\">\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 按鈕組 -->\r\n      <div class=\"button-group\">\r\n        <button class=\"reset-button\" @click=\"resetAll\">重新計算</button>\r\n        <button class=\"calculate-button\" @click=\"calculateEmissions\">計算碳排放</button>\r\n      </div>\r\n\r\n      <!-- 結果部分 -->\r\n      <div class=\"results\" v-if=\"totalEmission > 0\">\r\n        <h2>總碳排放量</h2>\r\n        <p>{{ totalEmission }} kg CO₂e</p>\r\n        <!-- 新增：視覺化條形圖 -->\r\n        <div id=\"bar-container\" style=\"display: flex; height: 20px;\">\r\n          <div v-for=\"(percentage, index) in percentages\" :key=\"index\" :style=\"{ backgroundColor: colors[index], width: percentage + '%' }\"></div>\r\n        </div>\r\n      </div>\r\n    </main>\r\n\r\n    <footer>\r\n      © 2024 餐點碳排放計算機 | 聯絡我們: (089)326141~326146\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      categories: [], // 類別列表\r\n      items: [], // 項目列表\r\n      selectedCategories: [{}, {}, {}], // 新增：存儲選擇的類別\r\n      selectedItems: [{}, {}, {}], // 新增：存儲選擇的項目\r\n      quantities: [0, 0, 0], // 新增：存儲輸入的數值\r\n      totalEmission: 0, // 總碳排放\r\n      percentages: [0, 0, 0], // 新增：存儲條形圖的百分比\r\n      colors: ['green', 'blue', 'orange'] // 新增：條形圖的顏色\r\n    };\r\n  },\r\n  methods: {\r\n    fetchCategories() {\r\n      fetch('/api/categories')\r\n        .then(response => response.json())\r\n        .then(data => {\r\n          this.categories = data;\r\n        });\r\n    },\r\n    fetchItems(index) { // 新增：根據選擇的類別獲取項目\r\n      const category = this.selectedCategories[index];\r\n      fetch(`/api/items/${category.category_id}`)\r\n        .then(response => response.json())\r\n        .then(data => {\r\n          this.$set(this.items, index, data);\r\n        });\r\n    },\r\n    setEmission(index) { // 新增：根據選擇的項目設置碳排放量\r\n      const item = this.selectedItems[index];\r\n      this.$set(this.quantities, index, item.carbon_emission);\r\n    },\r\n    calculateEmissions() { // 新增：計算總碳排放並生成百分比\r\n      const totalEmission = this.quantities.reduce((total, quantity) => total + quantity, 0);\r\n      this.totalEmission = totalEmission;\r\n\r\n      // 計算每個類別的百分比\r\n      this.percentages = this.quantities.map(quantity => (quantity / totalEmission) * 100);\r\n    },\r\n    resetAll() { // 新增：重置所有選擇和數據\r\n      this.selectedCategories = [{}, {}, {}];\r\n      this.selectedItems = [{}, {}, {}];\r\n      this.quantities = [0, 0, 0];\r\n      this.totalEmission = 0;\r\n      this.percentages = [0, 0, 0];\r\n    }\r\n  },\r\n  mounted() {\r\n    this.fetchCategories(); // 新增：頁面加載時獲取類別數據\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* 已在 style.css 中定義，這裡省略 */\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}