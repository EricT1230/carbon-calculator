{"ast":null,"code":"export default {\n  data() {\n    return {\n      categories: [],\n      // 類別列表\n      items: [],\n      // 項目列表\n      selectedCategories: [{}, {}, {}],\n      // 新增：存儲選擇的類別\n      selectedItems: [{}, {}, {}],\n      // 新增：存儲選擇的項目\n      quantities: [0, 0, 0],\n      // 新增：存儲輸入的數值\n      totalEmission: 0,\n      // 總碳排放\n      percentages: [0, 0, 0],\n      // 新增：存儲條形圖的百分比\n      colors: ['green', 'blue', 'orange'] // 新增：條形圖的顏色\n    };\n  },\n  methods: {\n    fetchCategories() {\n      fetch('/api/categories').then(response => response.json()).then(data => {\n        this.categories = data;\n      });\n    },\n    fetchItems(index) {\n      // 新增：根據選擇的類別獲取項目\n      const category = this.selectedCategories[index];\n      fetch(`/api/items/${category.category_id}`).then(response => response.json()).then(data => {\n        this.$set(this.items, index, data);\n      });\n    },\n    setEmission(index) {\n      // 新增：根據選擇的項目設置碳排放量\n      const item = this.selectedItems[index];\n      this.$set(this.quantities, index, item.carbon_emission);\n    },\n    calculateEmissions() {\n      // 新增：計算總碳排放並生成百分比\n      const totalEmission = this.quantities.reduce((total, quantity) => total + quantity, 0);\n      this.totalEmission = totalEmission;\n\n      // 計算每個類別的百分比\n      this.percentages = this.quantities.map(quantity => quantity / totalEmission * 100);\n    },\n    resetAll() {\n      // 新增：重置所有選擇和數據\n      this.selectedCategories = [{}, {}, {}];\n      this.selectedItems = [{}, {}, {}];\n      this.quantities = [0, 0, 0];\n      this.totalEmission = 0;\n      this.percentages = [0, 0, 0];\n    }\n  },\n  mounted() {\n    this.fetchCategories(); // 新增：頁面加載時獲取類別數據\n  }\n};","map":{"version":3,"names":["data","categories","items","selectedCategories","selectedItems","quantities","totalEmission","percentages","colors","methods","fetchCategories","fetch","then","response","json","fetchItems","index","category","category_id","$set","setEmission","item","carbon_emission","calculateEmissions","reduce","total","quantity","map","resetAll","mounted"],"sources":["C:\\Users\\user\\carbon-calculator\\src\\App.vue"],"sourcesContent":["<template>\r\n  <div id=\"app\">\r\n    <header>\r\n      <h1>餐點碳排放計算機</h1>\r\n      <p>計算您的餐點的碳排放量，助力環保</p>\r\n    </header>\r\n\r\n    <main>\r\n      <!-- 新增：使用 v-for 迴圈生成不同類別的選擇器 -->\r\n      <div class=\"ingredient-selection\">\r\n        <div v-for=\"(category, index) in categories\" :key=\"index\" class=\"ingredient-row\">\r\n          <!-- 類別選擇 -->\r\n          <select v-model=\"selectedCategories[index]\" @change=\"fetchItems(index)\">\r\n            <option disabled value=\"\">選擇種類</option>\r\n            <option v-for=\"cat in categories\" :key=\"cat.category_id\" :value=\"cat\">\r\n              {{ cat.category_name }}\r\n            </option>\r\n          </select>\r\n          \r\n          <!-- 項目選擇 -->\r\n          <select v-model=\"selectedItems[index]\" @change=\"setEmission(index)\">\r\n            <option disabled value=\"\">選擇名稱</option>\r\n            <option v-for=\"item in items[index]\" :key=\"item.item_id\" :value=\"item\">\r\n              {{ item.item_name }}\r\n            </option>\r\n          </select>\r\n\r\n          <!-- 數量輸入 -->\r\n          <input type=\"number\" v-model=\"quantities[index]\" placeholder=\"請輸入數值\">\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 按鈕組 -->\r\n      <div class=\"button-group\">\r\n        <button class=\"reset-button\" @click=\"resetAll\">重新計算</button>\r\n        <button class=\"calculate-button\" @click=\"calculateEmissions\">計算碳排放</button>\r\n      </div>\r\n\r\n      <!-- 結果部分 -->\r\n      <div class=\"results\" v-if=\"totalEmission > 0\">\r\n        <h2>總碳排放量</h2>\r\n        <p>{{ totalEmission }} kg CO₂e</p>\r\n        <!-- 新增：視覺化條形圖 -->\r\n        <div id=\"bar-container\" style=\"display: flex; height: 20px;\">\r\n          <div v-for=\"(percentage, index) in percentages\" :key=\"index\" :style=\"{ backgroundColor: colors[index], width: percentage + '%' }\"></div>\r\n        </div>\r\n      </div>\r\n    </main>\r\n\r\n    <footer>\r\n      © 2024 餐點碳排放計算機 | 聯絡我們: (089)326141~326146\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      categories: [], // 類別列表\r\n      items: [], // 項目列表\r\n      selectedCategories: [{}, {}, {}], // 新增：存儲選擇的類別\r\n      selectedItems: [{}, {}, {}], // 新增：存儲選擇的項目\r\n      quantities: [0, 0, 0], // 新增：存儲輸入的數值\r\n      totalEmission: 0, // 總碳排放\r\n      percentages: [0, 0, 0], // 新增：存儲條形圖的百分比\r\n      colors: ['green', 'blue', 'orange'] // 新增：條形圖的顏色\r\n    };\r\n  },\r\n  methods: {\r\n    fetchCategories() {\r\n      fetch('/api/categories')\r\n        .then(response => response.json())\r\n        .then(data => {\r\n          this.categories = data;\r\n        });\r\n    },\r\n    fetchItems(index) { // 新增：根據選擇的類別獲取項目\r\n      const category = this.selectedCategories[index];\r\n      fetch(`/api/items/${category.category_id}`)\r\n        .then(response => response.json())\r\n        .then(data => {\r\n          this.$set(this.items, index, data);\r\n        });\r\n    },\r\n    setEmission(index) { // 新增：根據選擇的項目設置碳排放量\r\n      const item = this.selectedItems[index];\r\n      this.$set(this.quantities, index, item.carbon_emission);\r\n    },\r\n    calculateEmissions() { // 新增：計算總碳排放並生成百分比\r\n      const totalEmission = this.quantities.reduce((total, quantity) => total + quantity, 0);\r\n      this.totalEmission = totalEmission;\r\n\r\n      // 計算每個類別的百分比\r\n      this.percentages = this.quantities.map(quantity => (quantity / totalEmission) * 100);\r\n    },\r\n    resetAll() { // 新增：重置所有選擇和數據\r\n      this.selectedCategories = [{}, {}, {}];\r\n      this.selectedItems = [{}, {}, {}];\r\n      this.quantities = [0, 0, 0];\r\n      this.totalEmission = 0;\r\n      this.percentages = [0, 0, 0];\r\n    }\r\n  },\r\n  mounted() {\r\n    this.fetchCategories(); // 新增：頁面加載時獲取類別數據\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* 已在 style.css 中定義，這裡省略 */\r\n</style>\r\n"],"mappings":"AAwDA,eAAe;EACbA,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,UAAU,EAAE,EAAE;MAAE;MAChBC,KAAK,EAAE,EAAE;MAAE;MACXC,kBAAkB,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MAAE;MAClCC,aAAa,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MAAE;MAC7BC,UAAU,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MAAE;MACvBC,aAAa,EAAE,CAAC;MAAE;MAClBC,WAAW,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MAAE;MACxBC,MAAM,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE;IACtC,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPC,eAAeA,CAAA,EAAG;MAChBC,KAAK,CAAC,iBAAiB,EACpBC,IAAI,CAACC,QAAO,IAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,EAChCF,IAAI,CAACZ,IAAG,IAAK;QACZ,IAAI,CAACC,UAAS,GAAID,IAAI;MACxB,CAAC,CAAC;IACN,CAAC;IACDe,UAAUA,CAACC,KAAK,EAAE;MAAE;MAClB,MAAMC,QAAO,GAAI,IAAI,CAACd,kBAAkB,CAACa,KAAK,CAAC;MAC/CL,KAAK,CAAC,cAAcM,QAAQ,CAACC,WAAW,EAAE,EACvCN,IAAI,CAACC,QAAO,IAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,EAChCF,IAAI,CAACZ,IAAG,IAAK;QACZ,IAAI,CAACmB,IAAI,CAAC,IAAI,CAACjB,KAAK,EAAEc,KAAK,EAAEhB,IAAI,CAAC;MACpC,CAAC,CAAC;IACN,CAAC;IACDoB,WAAWA,CAACJ,KAAK,EAAE;MAAE;MACnB,MAAMK,IAAG,GAAI,IAAI,CAACjB,aAAa,CAACY,KAAK,CAAC;MACtC,IAAI,CAACG,IAAI,CAAC,IAAI,CAACd,UAAU,EAAEW,KAAK,EAAEK,IAAI,CAACC,eAAe,CAAC;IACzD,CAAC;IACDC,kBAAkBA,CAAA,EAAG;MAAE;MACrB,MAAMjB,aAAY,GAAI,IAAI,CAACD,UAAU,CAACmB,MAAM,CAAC,CAACC,KAAK,EAAEC,QAAQ,KAAKD,KAAI,GAAIC,QAAQ,EAAE,CAAC,CAAC;MACtF,IAAI,CAACpB,aAAY,GAAIA,aAAa;;MAElC;MACA,IAAI,CAACC,WAAU,GAAI,IAAI,CAACF,UAAU,CAACsB,GAAG,CAACD,QAAO,IAAMA,QAAO,GAAIpB,aAAa,GAAI,GAAG,CAAC;IACtF,CAAC;IACDsB,QAAQA,CAAA,EAAG;MAAE;MACX,IAAI,CAACzB,kBAAiB,GAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MACtC,IAAI,CAACC,aAAY,GAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MACjC,IAAI,CAACC,UAAS,GAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;MAC3B,IAAI,CAACC,aAAY,GAAI,CAAC;MACtB,IAAI,CAACC,WAAU,GAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAC9B;EACF,CAAC;EACDsB,OAAOA,CAAA,EAAG;IACR,IAAI,CAACnB,eAAe,CAAC,CAAC,EAAE;EAC1B;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}